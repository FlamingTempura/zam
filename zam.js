!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.zam=t()}(this,function(){"use strict";var e=function(){function e(e,t){function r(){this.constructor=e}r.prototype=t.prototype,e.prototype=new r}function t(e,r,n,o){this.message=e,this.expected=r,this.found=n,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}function r(e,r){function n(){return e.substring(Fr,Tr)}function o(e,t){return{type:"literal",text:e,ignoreCase:t}}function i(e,t,r){return{type:"class",parts:e,inverted:t,ignoreCase:r}}function u(){return{type:"any"}}function a(){return{type:"end"}}function s(e){return{type:"other",description:e}}function c(t){var r,n=Mr[t];if(n)return n;for(r=t-1;!Mr[r];)r--;for(n=Mr[r],n={line:n.line,column:n.column};r<t;)10===e.charCodeAt(r)?(n.line++,n.column=1):n.column++,r++;return Mr[t]=n,n}function l(e,t){var r=c(e),n=c(t);return{start:{offset:e,line:r.line,column:r.column},end:{offset:t,line:n.line,column:n.column}}}function f(e){Tr<Rr||(Tr>Rr&&(Rr=Tr,Ur=[]),Ur.push(e))}function d(e,r,n){return new t(t.buildMessage(e,r),e,r,n)}function p(){var t,r,n,o,i=32*Tr+0,u=Br[i];if(u)return Tr=u.nextPos,u.result;for(t=Tr,r=[],Q.test(e.charAt(Tr))?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(W));n!==J;)r.push(n),Q.test(e.charAt(Tr))?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(W));if(r!==J?(n=h(),n!==J?(o=p(),o!==J?(Fr=t,r=X(r,n,o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J){for(t=Tr,r=[],e.length>Tr?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(Y));n!==J;)r.push(n),e.length>Tr?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(Y));r!==J&&(Fr=t,r=Z(r)),t=r}return Br[i]={nextPos:Tr,result:t},t}function h(){var t,r,n,o,i,u,a=32*Tr+1,s=Br[a];return s?(Tr=s.nextPos,s.result):(t=Tr,"{{{"===e.substr(Tr,3)?(r=ee,Tr+=3):(r=J,0===qr&&f(te)),r!==J?(n=I(),n!==J?(o=v(),o!==J?(i=I(),i!==J?("}}}"===e.substr(Tr,3)?(u=re,Tr+=3):(u=J,0===qr&&f(ne)),u!==J?(Fr=t,r=oe(o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=Tr,"{{"===e.substr(Tr,2)?(r=ie,Tr+=2):(r=J,0===qr&&f(ue)),r!==J?(n=I(),n!==J?(o=v(),o!==J?(i=I(),i!==J?("}}"===e.substr(Tr,2)?(u=ae,Tr+=2):(u=J,0===qr&&f(se)),u!==J?(Fr=t,r=ce(o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)),Br[a]={nextPos:Tr,result:t},t)}function v(){var t,r,n,o,i,u,a=32*Tr+2,s=Br[a];return s?(Tr=s.nextPos,s.result):(t=Tr,r=m(),r!==J?(n=I(),n!==J?(61===e.charCodeAt(Tr)?(o=le,Tr++):(o=J,0===qr&&f(fe)),o===J&&("*="===e.substr(Tr,2)?(o=de,Tr+=2):(o=J,0===qr&&f(pe)),o===J&&("/="===e.substr(Tr,2)?(o=he,Tr+=2):(o=J,0===qr&&f(ve)),o===J&&("%="===e.substr(Tr,2)?(o=me,Tr+=2):(o=J,0===qr&&f(be)),o===J&&("+="===e.substr(Tr,2)?(o=xe,Tr+=2):(o=J,0===qr&&f(ye)),o===J&&("-="===e.substr(Tr,2)?(o=ge,Tr+=2):(o=J,0===qr&&f(Ae))))))),o!==J?(i=I(),i!==J?(u=v(),u!==J?(Fr=t,r=Pe(r,o,u),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=b()),Br[a]={nextPos:Tr,result:t},t)}function m(){var e,t=32*Tr+3,r=Br[t];return r?(Tr=r.nextPos,r.result):(e=E(),e===J&&(e=$()),Br[t]={nextPos:Tr,result:e},e)}function b(){var t,r,n,o,i,u,a,s,c,l,d=32*Tr+4,p=Br[d];return p?(Tr=p.nextPos,p.result):(t=Tr,r=x(),r!==J?(n=I(),n!==J?(63===e.charCodeAt(Tr)?(o=Ce,Tr++):(o=J,0===qr&&f(we)),o!==J?(i=I(),i!==J?(u=b(),u!==J?(a=I(),a!==J?(58===e.charCodeAt(Tr)?(s=ke,Tr++):(s=J,0===qr&&f(Ee)),s!==J?(c=I(),c!==J?(l=b(),l!==J?(Fr=t,r=$e(r,u,l),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=x()),Br[d]={nextPos:Tr,result:t},t)}function x(){var t,r,n,o,i,u,a,s,c=32*Tr+5,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=y(),r!==J){for(n=[],o=Tr,i=I(),i!==J?("||"===e.substr(Tr,2)?(u=je,Tr+=2):(u=J,0===qr&&f(Ve)),u!==J?(a=I(),a!==J?(s=y(),s!==J?(Fr=o,i=Le(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?("||"===e.substr(Tr,2)?(u=je,Tr+=2):(u=J,0===qr&&f(Ve)),u!==J?(a=I(),a!==J?(s=y(),s!==J?(Fr=o,i=Le(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=Ne(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function y(){var t,r,n,o,i,u,a,s,c=32*Tr+6,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=g(),r!==J){for(n=[],o=Tr,i=I(),i!==J?("&&"===e.substr(Tr,2)?(u=ze,Tr+=2):(u=J,0===qr&&f(Oe)),u!==J?(a=I(),a!==J?(s=g(),s!==J?(Fr=o,i=Se(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?("&&"===e.substr(Tr,2)?(u=ze,Tr+=2):(u=J,0===qr&&f(Oe)),u!==J?(a=I(),a!==J?(s=g(),s!==J?(Fr=o,i=Se(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=Ne(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function g(){var t,r,n,o,i,u,a,s,c=32*Tr+7,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=A(),r!==J){for(n=[],o=Tr,i=I(),i!==J?("==="===e.substr(Tr,3)?(u=Te,Tr+=3):(u=J,0===qr&&f(Fe)),u===J&&("!=="===e.substr(Tr,3)?(u=Me,Tr+=3):(u=J,0===qr&&f(Re)),u===J&&("=="===e.substr(Tr,2)?(u=Ue,Tr+=2):(u=J,0===qr&&f(qe)),u===J&&("!="===e.substr(Tr,2)?(u=Be,Tr+=2):(u=J,0===qr&&f(De))))),u!==J?(a=I(),a!==J?(s=A(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?("==="===e.substr(Tr,3)?(u=Te,Tr+=3):(u=J,0===qr&&f(Fe)),u===J&&("!=="===e.substr(Tr,3)?(u=Me,Tr+=3):(u=J,0===qr&&f(Re)),u===J&&("=="===e.substr(Tr,2)?(u=Ue,Tr+=2):(u=J,0===qr&&f(qe)),u===J&&("!="===e.substr(Tr,2)?(u=Be,Tr+=2):(u=J,0===qr&&f(De))))),u!==J?(a=I(),a!==J?(s=A(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=_e(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function A(){var t,r,n,o,i,u,a,s,c=32*Tr+8,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=P(),r!==J){for(n=[],o=Tr,i=I(),i!==J?("<="===e.substr(Tr,2)?(u=He,Tr+=2):(u=J,0===qr&&f(Je)),u===J&&(">="===e.substr(Tr,2)?(u=Ge,Tr+=2):(u=J,0===qr&&f(Ke)),u===J&&(60===e.charCodeAt(Tr)?(u=Qe,Tr++):(u=J,0===qr&&f(We)),u===J&&(62===e.charCodeAt(Tr)?(u=Xe,Tr++):(u=J,0===qr&&f(Ye))))),u!==J?(a=I(),a!==J?(s=P(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?("<="===e.substr(Tr,2)?(u=He,Tr+=2):(u=J,0===qr&&f(Je)),u===J&&(">="===e.substr(Tr,2)?(u=Ge,Tr+=2):(u=J,0===qr&&f(Ke)),u===J&&(60===e.charCodeAt(Tr)?(u=Qe,Tr++):(u=J,0===qr&&f(We)),u===J&&(62===e.charCodeAt(Tr)?(u=Xe,Tr++):(u=J,0===qr&&f(Ye))))),u!==J?(a=I(),a!==J?(s=P(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=_e(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function P(){var t,r,n,o,i,u,a,s,c=32*Tr+9,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=C(),r!==J){for(n=[],o=Tr,i=I(),i!==J?(Ze.test(e.charAt(Tr))?(u=e.charAt(Tr),Tr++):(u=J,0===qr&&f(et)),u!==J?(a=I(),a!==J?(s=C(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?(Ze.test(e.charAt(Tr))?(u=e.charAt(Tr),Tr++):(u=J,0===qr&&f(et)),u!==J?(a=I(),a!==J?(s=C(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=_e(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function C(){var t,r,n,o,i,u,a,s,c=32*Tr+10,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=w(),r!==J){for(n=[],o=Tr,i=I(),i!==J?(tt.test(e.charAt(Tr))?(u=e.charAt(Tr),Tr++):(u=J,0===qr&&f(rt)),u!==J?(a=I(),a!==J?(s=w(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?(tt.test(e.charAt(Tr))?(u=e.charAt(Tr),Tr++):(u=J,0===qr&&f(rt)),u!==J?(a=I(),a!==J?(s=w(),s!==J?(Fr=o,i=Ie(r,u,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=_e(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function w(){var t,r,n,o,i=32*Tr+11,u=Br[i];return u?(Tr=u.nextPos,u.result):(t=k(),t===J&&(t=Tr,"++"===e.substr(Tr,2)?(r=nt,Tr+=2):(r=J,0===qr&&f(ot)),r===J&&("--"===e.substr(Tr,2)?(r=it,Tr+=2):(r=J,0===qr&&f(ut)),r===J&&(at.test(e.charAt(Tr))?(r=e.charAt(Tr),Tr++):(r=J,0===qr&&f(st)))),r!==J?(n=I(),n!==J?(o=w(),o!==J?(Fr=t,r=ct(r,o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)),Br[i]={nextPos:Tr,result:t},t)}function k(){var t,r,n,o,i=32*Tr+12,u=Br[i];return u?(Tr=u.nextPos,u.result):(t=Tr,r=m(),r!==J?(n=I(),n!==J?("++"===e.substr(Tr,2)?(o=nt,Tr+=2):(o=J,0===qr&&f(ot)),o===J&&("--"===e.substr(Tr,2)?(o=it,Tr+=2):(o=J,0===qr&&f(ut))),o!==J?(Fr=t,r=lt(r,o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=m()),Br[i]={nextPos:Tr,result:t},t)}function E(){var e,t,r,n,o,i=32*Tr+13,u=Br[i];return u?(Tr=u.nextPos,u.result):(e=Tr,t=Tr,r=$(),r!==J?(n=I(),n!==J?(o=L(),o!==J?(Fr=t,r=ft(r,o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t!==J?(r=j(),r!==J?(Fr=e,t=dt(t,r),e=t):(Tr=e,e=J)):(Tr=e,e=J),Br[i]={nextPos:Tr,result:e},e)}function $(){var t,r,n,o,i,u,a,s=32*Tr+14,c=Br[s];return c?(Tr=c.nextPos,c.result):(t=Tr,r=V(),r===J&&(r=N(),r===J&&(r=M(),r===J&&(r=z(),r===J&&(r=S(),r===J&&(r=Tr,40===e.charCodeAt(Tr)?(n=pt,Tr++):(n=J,0===qr&&f(ht)),n!==J?(o=I(),o!==J?(i=v(),i!==J?(u=I(),u!==J?(41===e.charCodeAt(Tr)?(a=vt,Tr++):(a=J,0===qr&&f(mt)),a!==J?(Fr=r,n=bt(i),r=n):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)))))),r!==J?(n=j(),n!==J?(Fr=t,r=xt(r,n),t=r):(Tr=t,t=J)):(Tr=t,t=J),Br[s]={nextPos:Tr,result:t},t)}function j(){var t,r,n,o,i,u,a,s,c=32*Tr+15,l=Br[c];if(l)return Tr=l.nextPos,l.result;for(t=[],r=Tr,n=I(),n!==J?(91===e.charCodeAt(Tr)?(o=yt,Tr++):(o=J,0===qr&&f(gt)),o!==J?(i=I(),i!==J?(u=v(),u!==J?(a=I(),a!==J?(93===e.charCodeAt(Tr)?(s=At,Tr++):(s=J,0===qr&&f(Pt)),s!==J?(Fr=r,n=Ct(u),r=n):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J),r===J&&(r=Tr,n=I(),n!==J?(46===e.charCodeAt(Tr)?(o=wt,Tr++):(o=J,0===qr&&f(kt)),o!==J?(i=I(),i!==J?(u=N(),u!==J?(Fr=r,n=Et(u),r=n):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J));r!==J;)t.push(r),r=Tr,n=I(),n!==J?(91===e.charCodeAt(Tr)?(o=yt,Tr++):(o=J,0===qr&&f(gt)),o!==J?(i=I(),i!==J?(u=v(),u!==J?(a=I(),a!==J?(93===e.charCodeAt(Tr)?(s=At,Tr++):(s=J,0===qr&&f(Pt)),s!==J?(Fr=r,n=Ct(u),r=n):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J),r===J&&(r=Tr,n=I(),n!==J?(46===e.charCodeAt(Tr)?(o=wt,Tr++):(o=J,0===qr&&f(kt)),o!==J?(i=I(),i!==J?(u=N(),u!==J?(Fr=r,n=Et(u),r=n):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J)):(Tr=r,r=J));return Br[c]={nextPos:Tr,result:t},t}function V(){var t,r,n,o,i,u,a,s=32*Tr+16,c=Br[s];return c?(Tr=c.nextPos,c.result):(t=Tr,"new"===e.substr(Tr,3)?(r=$t,Tr+=3):(r=J,0===qr&&f(jt)),r!==J?(n=_(),n!==J?(o=$(),o!==J?(i=Tr,u=I(),u!==J?(a=L(),a!==J?(Fr=i,u=Vt(o,a),i=u):(Tr=i,i=J)):(Tr=i,i=J),i===J&&(i=null),i!==J?(Fr=t,r=Lt(o,i),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),Br[s]={nextPos:Tr,result:t},t)}function L(){var t,r,n,o,i,u,a,s,c,l,d=32*Tr+17,p=Br[d];if(p)return Tr=p.nextPos,p.result;if(t=Tr,40===e.charCodeAt(Tr)?(r=pt,Tr++):(r=J,0===qr&&f(ht)),r!==J?(n=I(),n!==J?(41===e.charCodeAt(Tr)?(o=vt,Tr++):(o=J,0===qr&&f(mt)),o!==J?(Fr=t,r=Nt(),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J)if(t=Tr,40===e.charCodeAt(Tr)?(r=pt,Tr++):(r=J,0===qr&&f(ht)),r!==J)if(n=I(),n!==J)if(o=v(),o!==J){for(i=[],u=Tr,a=I(),a!==J?(44===e.charCodeAt(Tr)?(s=zt,Tr++):(s=J,0===qr&&f(Ot)),s!==J?(c=I(),c!==J?(l=v(),l!==J?(Fr=u,a=St(o,l),u=a):(Tr=u,u=J)):(Tr=u,u=J)):(Tr=u,u=J)):(Tr=u,u=J);u!==J;)i.push(u),u=Tr,a=I(),a!==J?(44===e.charCodeAt(Tr)?(s=zt,Tr++):(s=J,0===qr&&f(Ot)),s!==J?(c=I(),c!==J?(l=v(),l!==J?(Fr=u,a=St(o,l),u=a):(Tr=u,u=J)):(Tr=u,u=J)):(Tr=u,u=J)):(Tr=u,u=J);i!==J?(u=I(),u!==J?(41===e.charCodeAt(Tr)?(a=vt,Tr++):(a=J,0===qr&&f(mt)),a!==J?(Fr=t,r=Tt(o,i),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)}else Tr=t,t=J;else Tr=t,t=J;else Tr=t,t=J;return Br[d]={nextPos:Tr,result:t},t}function N(){var t,r,n,o,i,u=32*Tr+18,a=Br[u];if(a)return Tr=a.nextPos,a.result;if(qr++,t=Tr,r=Tr,qr++,n=R(),qr--,n===J?r=void 0:(Tr=r,r=J),r!==J)if(Mt.test(e.charAt(Tr))?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(Rt)),n!==J){for(o=[],Ut.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(qt));i!==J;)o.push(i),Ut.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(qt));o!==J?(Fr=t,r=Bt(n,o),t=r):(Tr=t,t=J)}else Tr=t,t=J;else Tr=t,t=J;return qr--,t===J&&(r=J,0===qr&&f(Ft)),Br[u]={nextPos:Tr,result:t},t}function z(){var t,r,n,o,i,u,a=32*Tr+19,s=Br[a];return s?(Tr=s.nextPos,s.result):(t=Tr,91===e.charCodeAt(Tr)?(r=yt,Tr++):(r=J,0===qr&&f(gt)),r!==J?(n=I(),n!==J?(93===e.charCodeAt(Tr)?(o=At,Tr++):(o=J,0===qr&&f(Pt)),o!==J?(Fr=t,r=Dt(),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=Tr,91===e.charCodeAt(Tr)?(r=yt,Tr++):(r=J,0===qr&&f(gt)),r!==J?(n=I(),n!==J?(o=O(),o!==J?(i=I(),i!==J?(93===e.charCodeAt(Tr)?(u=At,Tr++):(u=J,0===qr&&f(Pt)),u!==J?(Fr=t,r=It(o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)),Br[a]={nextPos:Tr,result:t},t)}function O(){var t,r,n,o,i,u,a,s,c=32*Tr+20,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=v(),r!==J){for(n=[],o=Tr,i=I(),i!==J?(44===e.charCodeAt(Tr)?(u=zt,Tr++):(u=J,0===qr&&f(Ot)),u!==J?(a=I(),a!==J?(s=v(),s!==J?(Fr=o,i=_t(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?(44===e.charCodeAt(Tr)?(u=zt,Tr++):(u=J,0===qr&&f(Ot)),u!==J?(a=I(),a!==J?(s=v(),s!==J?(Fr=o,i=_t(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=Tt(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function S(){var t,r,n,o,i,u,a,s,c=32*Tr+21,l=Br[c];return l?(Tr=l.nextPos,l.result):(t=Tr,123===e.charCodeAt(Tr)?(r=Ht,Tr++):(r=J,0===qr&&f(Jt)),r!==J?(n=I(),n!==J?(125===e.charCodeAt(Tr)?(o=Gt,Tr++):(o=J,0===qr&&f(Kt)),o!==J?(Fr=t,r=Qt(),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),t===J&&(t=Tr,123===e.charCodeAt(Tr)?(r=Ht,Tr++):(r=J,0===qr&&f(Jt)),r!==J?(n=I(),n!==J?(o=T(),o!==J?(i=I(),i!==J?(u=Tr,44===e.charCodeAt(Tr)?(a=zt,Tr++):(a=J,0===qr&&f(Ot)),a!==J?(s=I(),s!==J?(a=[a,s],u=a):(Tr=u,u=J)):(Tr=u,u=J),u===J&&(u=null),u!==J?(125===e.charCodeAt(Tr)?(a=Gt,Tr++):(a=J,0===qr&&f(Kt)),a!==J?(Fr=t,r=Wt(o),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)),Br[c]={nextPos:Tr,result:t},t)}function T(){var t,r,n,o,i,u,a,s,c=32*Tr+22,l=Br[c];if(l)return Tr=l.nextPos,l.result;if(t=Tr,r=F(),r!==J){for(n=[],o=Tr,i=I(),i!==J?(44===e.charCodeAt(Tr)?(u=zt,Tr++):(u=J,0===qr&&f(Ot)),u!==J?(a=I(),a!==J?(s=F(),s!==J?(Fr=o,i=Xt(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);o!==J;)n.push(o),o=Tr,i=I(),i!==J?(44===e.charCodeAt(Tr)?(u=zt,Tr++):(u=J,0===qr&&f(Ot)),u!==J?(a=I(),a!==J?(s=F(),s!==J?(Fr=o,i=Xt(r,s),o=i):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J)):(Tr=o,o=J);n!==J?(Fr=t,r=Tt(r,n),t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[c]={nextPos:Tr,result:t},t}function F(){var t,r,n,o,i,u,a=32*Tr+23,s=Br[a];return s?(Tr=s.nextPos,s.result):(t=Tr,r=N(),r===J&&(r=D(),r===J&&(r=U())),r!==J?(n=I(),n!==J?(58===e.charCodeAt(Tr)?(o=ke,Tr++):(o=J,0===qr&&f(Ee)),o!==J?(i=I(),i!==J?(u=v(),u!==J?(Fr=t,r=Yt(r,u),t=r):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J)):(Tr=t,t=J),Br[a]={nextPos:Tr,result:t},t)}function M(){var e,t=32*Tr+24,r=Br[t];return r?(Tr=r.nextPos,r.result):(e=R(),e===J&&(e=U(),e===J&&(e=D())),Br[t]={nextPos:Tr,result:e},e)}function R(){var t,r,n=32*Tr+25,o=Br[n];return o?(Tr=o.nextPos,o.result):(t=Tr,"null"===e.substr(Tr,4)?(r=Zt,Tr+=4):(r=J,0===qr&&f(er)),r!==J&&(Fr=t,r=tr()),t=r,t===J&&(t=Tr,"true"===e.substr(Tr,4)?(r=rr,Tr+=4):(r=J,0===qr&&f(nr)),r!==J&&(Fr=t,r=or()),t=r,t===J&&(t=Tr,"false"===e.substr(Tr,5)?(r=ir,Tr+=5):(r=J,0===qr&&f(ur)),r!==J&&(Fr=t,r=ar()),t=r)),Br[n]={nextPos:Tr,result:t},t)}function U(){var t,r,n,o,i,u=32*Tr+26,a=Br[u];if(a)return Tr=a.nextPos,a.result;if(qr++,t=Tr,r=q(),r!==J)if(46===e.charCodeAt(Tr)?(n=wt,Tr++):(n=J,0===qr&&f(kt)),n!==J){for(o=[],cr.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(lr));i!==J;)o.push(i),cr.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(lr));o!==J?(i=B(),i===J&&(i=null),i!==J?(Fr=t,r=fr(),t=r):(Tr=t,t=J)):(Tr=t,t=J)}else Tr=t,t=J;else Tr=t,t=J;if(t===J){if(t=Tr,46===e.charCodeAt(Tr)?(r=wt,Tr++):(r=J,0===qr&&f(kt)),r!==J){if(n=[],cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(lr)),o!==J)for(;o!==J;)n.push(o),cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(lr));else n=J;n!==J?(o=B(),o===J&&(o=null),o!==J?(Fr=t,r=fr(),t=r):(Tr=t,t=J)):(Tr=t,t=J)}else Tr=t,t=J;t===J&&(t=Tr,r=q(),r!==J?(n=B(),n===J&&(n=null),n!==J?(Fr=t,r=fr(),t=r):(Tr=t,t=J)):(Tr=t,t=J))}return qr--,t===J&&(r=J,0===qr&&f(sr)),Br[u]={nextPos:Tr,result:t},t}function q(){var t,r,n,o,i=32*Tr+27,u=Br[i];if(u)return Tr=u.nextPos,u.result;if(48===e.charCodeAt(Tr)?(t=dr,Tr++):(t=J,0===qr&&f(pr)),t===J)if(t=Tr,hr.test(e.charAt(Tr))?(r=e.charAt(Tr),Tr++):(r=J,0===qr&&f(vr)),r!==J){for(n=[],cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(lr));o!==J;)n.push(o),cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(lr));n!==J?(r=[r,n],t=r):(Tr=t,t=J)}else Tr=t,t=J;return Br[i]={nextPos:Tr,result:t},t}function B(){var t,r,n,o,i,u=32*Tr+28,a=Br[u];if(a)return Tr=a.nextPos,a.result;if(t=Tr,"e"===e.substr(Tr,1).toLowerCase()?(r=e.charAt(Tr),Tr++):(r=J,0===qr&&f(mr)),r!==J)if(Ze.test(e.charAt(Tr))?(n=e.charAt(Tr),Tr++):(n=J,0===qr&&f(et)),n===J&&(n=null),n!==J){if(o=[],cr.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(lr)),i!==J)for(;i!==J;)o.push(i),cr.test(e.charAt(Tr))?(i=e.charAt(Tr),Tr++):(i=J,0===qr&&f(lr));else o=J;o!==J?(r=[r,n,o],t=r):(Tr=t,t=J)}else Tr=t,t=J;else Tr=t,t=J;return Br[u]={nextPos:Tr,result:t},t}function D(){var t,r,n,o,i,u=32*Tr+29,a=Br[u];if(a)return Tr=a.nextPos,a.result;if(qr++,t=Tr,34===e.charCodeAt(Tr)?(r=xr,Tr++):(r=J,0===qr&&f(yr)),r!==J){for(n=[],o=Tr,'\\"'===e.substr(Tr,2)?(i=gr,Tr+=2):(i=J,0===qr&&f(Ar)),i!==J&&(Fr=o,i=Pr()),o=i,o===J&&(Cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(wr)));o!==J;)n.push(o),o=Tr,'\\"'===e.substr(Tr,2)?(i=gr,Tr+=2):(i=J,0===qr&&f(Ar)),i!==J&&(Fr=o,i=Pr()),o=i,o===J&&(Cr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(wr)));n!==J?(34===e.charCodeAt(Tr)?(o=xr,Tr++):(o=J,0===qr&&f(yr)),o!==J?(Fr=t,r=kr(n),t=r):(Tr=t,t=J)):(Tr=t,t=J)}else Tr=t,t=J;if(t===J)if(t=Tr,39===e.charCodeAt(Tr)?(r=Er,Tr++):(r=J,0===qr&&f($r)),r!==J){for(n=[],o=Tr,"\\'"===e.substr(Tr,2)?(i=jr,Tr+=2):(i=J,0===qr&&f(Vr)),i!==J&&(Fr=o,i=Lr()),o=i,o===J&&(Nr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(zr)));o!==J;)n.push(o),o=Tr,"\\'"===e.substr(Tr,2)?(i=jr,Tr+=2):(i=J,0===qr&&f(Vr)),i!==J&&(Fr=o,i=Lr()),o=i,o===J&&(Nr.test(e.charAt(Tr))?(o=e.charAt(Tr),Tr++):(o=J,0===qr&&f(zr)));n!==J?(39===e.charCodeAt(Tr)?(o=Er,Tr++):(o=J,0===qr&&f($r)),o!==J?(Fr=t,r=kr(n),t=r):(Tr=t,t=J)):(Tr=t,t=J)}else Tr=t,t=J;return qr--,t===J&&(r=J,0===qr&&f(br)),Br[u]={nextPos:Tr,result:t},t}function I(){var e,t=32*Tr+30,r=Br[t];return r?(Tr=r.nextPos,r.result):(e=_(),e===J&&(e=null),Br[t]={nextPos:Tr,result:e},e)}function _(){var t,r,n=32*Tr+31,o=Br[n];if(o)return Tr=o.nextPos,o.result;if(t=[],Or.test(e.charAt(Tr))?(r=e.charAt(Tr),Tr++):(r=J,0===qr&&f(Sr)),r!==J)for(;r!==J;)t.push(r),Or.test(e.charAt(Tr))?(r=e.charAt(Tr),Tr++):(r=J,0===qr&&f(Sr));else t=J;return Br[n]={nextPos:Tr,result:t},t}r=void 0!==r?r:{};var H,J={},G={Text:p,Expression:v},K=p,Q=/^[^{]/,W=i(["{"],!0,!1),X=function(e,t,r){return(e.length>0?[e.join("")]:[]).concat([t],r)},Y=u(),Z=function(e){return e.length>0?[e.join("")]:[]},ee="{{{",te=o("{{{",!1),re="}}}",ne=o("}}}",!1),oe=function(e){return{html:!0,expression:e}},ie="{{",ue=o("{{",!1),ae="}}",se=o("}}",!1),ce=function(e){return{html:!1,expression:e}},le="=",fe=o("=",!1),de="*=",pe=o("*=",!1),he="/=",ve=o("/=",!1),me="%=",be=o("%=",!1),xe="+=",ye=o("+=",!1),ge="-=",Ae=o("-=",!1),Pe=function(e,t,r){return{type:"Assignment",operator:t,left:e,right:r}},Ce="?",we=o("?",!1),ke=":",Ee=o(":",!1),$e=function(e,t,r){return{type:"Conditional",test:e,consequent:t,alternate:r}},je="||",Ve=o("||",!1),Le=function(e,t){return{operator:"||",arg:t}},Ne=function(e,t){return Dr("Logical",e,t)},ze="&&",Oe=o("&&",!1),Se=function(e,t){return{operator:"&&",arg:t}},Te="===",Fe=o("===",!1),Me="!==",Re=o("!==",!1),Ue="==",qe=o("==",!1),Be="!=",De=o("!=",!1),Ie=function(e,t,r){return{operator:t,arg:r}},_e=function(e,t){return Dr("Binary",e,t)},He="<=",Je=o("<=",!1),Ge=">=",Ke=o(">=",!1),Qe="<",We=o("<",!1),Xe=">",Ye=o(">",!1),Ze=/^[+\-]/,et=i(["+","-"],!1,!1),tt=/^[*\/%]/,rt=i(["*","/","%"],!1,!1),nt="++",ot=o("++",!1),it="--",ut=o("--",!1),at=/^[+!\-]/,st=i(["+","!","-"],!1,!1),ct=function(e,t){return{type:"++"===e||"--"===e?"Update":"Unary",operator:e,argument:t,prefix:!0}},lt=function(e,t){return{type:"Update",operator:t,argument:e,prefix:!1}},ft=function(e,t){return{type:"Call",callee:e,arguments:t}},dt=function(e,t){return t.reduce(function(e,t){return{type:"Member",property:t,object:e}},e)},pt="(",ht=o("(",!1),vt=")",mt=o(")",!1),bt=function(e){return e},xt=function(e,t){return t.reduce(function(e,t){return{type:"Member",object:e,property:t}},e)},yt="[",gt=o("[",!1),At="]",Pt=o("]",!1),Ct=function(e){return e},wt=".",kt=o(".",!1),Et=function(e){return{type:"Literal",value:e.name}},$t="new",jt=o("new",!1),Vt=function(e,t){return t},Lt=function(e,t){return{type:"NewExpression",callee:e,arguments:t||[]}},Nt=function(){return[]},zt=",",Ot=o(",",!1),St=function(e,t){return t},Tt=function(e,t){return[e].concat(t)},Ft=s("identifier"),Mt=/^[a-z$_]/i,Rt=i([["a","z"],"$","_"],!1,!0),Ut=/^[a-z$_0-9]/i,qt=i([["a","z"],"$","_",["0","9"]],!1,!0),Bt=function(e,t){return{type:"Identifier",name:e+t.join("")}},Dt=function(){return{type:"Array",elements:[]}},It=function(e){return{type:"Array",elements:e}},_t=function(e,t){return t},Ht="{",Jt=o("{",!1),Gt="}",Kt=o("}",!1),Qt=function(){return{type:"Object",properties:[]}},Wt=function(e){return{type:"Object",properties:e}},Xt=function(e,t){return t},Yt=function(e,t){return{type:"Property",key:e.name||e.value,value:t}},Zt="null",er=o("null",!1),tr=function(){return{type:"Literal",value:null}},rr="true",nr=o("true",!1),or=function(){return{type:"Literal",value:!0}},ir="false",ur=o("false",!1),ar=function(){return{type:"Literal",value:!1}},sr=s("number"),cr=/^[0-9]/,lr=i([["0","9"]],!1,!1),fr=function(){return{type:"Literal",value:parseFloat(n())}},dr="0",pr=o("0",!1),hr=/^[1-9]/,vr=i([["1","9"]],!1,!1),mr=o("e",!0),br=s("string"),xr='"',yr=o('"',!1),gr='\\"',Ar=o('\\"',!1),Pr=function(){return'"'},Cr=/^[^"]/,wr=i(['"'],!0,!1),kr=function(e){return{type:"Literal",value:e.join("")}},Er="'",$r=o("'",!1),jr="\\'",Vr=o("\\'",!1),Lr=function(){return"'"},Nr=/^[^'']/,zr=i(["'","'"],!0,!1),Or=/^[\t ]/,Sr=i(["\t"," "],!1,!1),Tr=0,Fr=0,Mr=[{line:1,column:1}],Rr=0,Ur=[],qr=0,Br={};if("startRule"in r){if(!(r.startRule in G))throw new Error("Can't start parsing from rule \""+r.startRule+'".');K=G[r.startRule]}var Dr=function(e,t,r){return 0===r.length?t:r.reduce(function(t,r){return{type:e,operator:r.operator,left:t,right:r.arg}},t)};if(H=K(),H!==J&&Tr===e.length)return H;throw H!==J&&Tr<e.length&&f(a()),d(Ur,Rr<e.length?e.charAt(Rr):null,Rr<e.length?l(Rr,Rr+1):l(Rr,Rr))}return e(t,Error),t.buildMessage=function(e,t){function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function n(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function o(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(e){return"\\x0"+r(e)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(e){return"\\x"+r(e)})}function i(e){return s[e.type](e)}function u(e){var t,r,n=new Array(e.length);for(t=0;t<e.length;t++)n[t]=i(e[t]);if(n.sort(),n.length>0){for(t=1,r=1;t<n.length;t++)n[t-1]!==n[t]&&(n[r]=n[t],r++);n.length=r}switch(n.length){case 1:return n[0];case 2:return n[0]+" or "+n[1];default:return n.slice(0,-1).join(", ")+", or "+n[n.length-1]}}function a(e){return e?'"'+n(e)+'"':"end of input"}var s={literal:function(e){return'"'+n(e.text)+'"'},class:function(e){var t,r="";for(t=0;t<e.parts.length;t++)r+=e.parts[t]instanceof Array?o(e.parts[t][0])+"-"+o(e.parts[t][1]):o(e.parts[t]);return"["+(e.inverted?"^":"")+r+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};return"Expected "+u(e)+" but "+a(t)+" found."},{SyntaxError:t,parse:r}}(),t=function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Expression";return e.parse(t,{startRule:r})},r=function(e){return String(null!==e&&"undefined"!=typeof e?e:"")},n=function(e,t){var r=e.indexOf(t);r>-1&&e.splice(r,1)},o=function(e){return e.split("").reduce(function(e,t){return(e<<5)-e+t.charCodeAt(0)|0},0).toString(16)},i="undefined"!=typeof process?process.nextTick:function(e){var t=String(Math.random()),r=function r(n){n.data===t&&(n.stopPropagation(),e(),window.removeEventListener("message",r,!0))};window.addEventListener("message",r,!0),window.postMessage(t,"*")},u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},s=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},c=void 0,l=function e(t,r){t.forEach(function(t){r(t),e(t.children,r)})},f=function e(t,n){var o=void 0,i=void 0,u=t.type,a=t.operator;if("Literal"===u)o=t.value;else if("Array"===u)o=t.elements.map(function(t){return e(t,n).value});else if("Object"===u)o={},t.properties.forEach(function(t){o[t.key]=e(t.value,n).value});else if("Identifier"===u){for(var s=n;s&&"undefined"==typeof s[t.name];)s=s.$parent;s||(s=n),o=s[t.name],i=function(e){return s[t.name]=e,e}}else if("Member"===u){var c=e(t.object,n).value,l=e(t.property,n).value;o="undefined"!=typeof c?c[l]:void 0,i=function(e){return c[l]=e,e}}else if("Conditional"===u)o=e(t.test,n).value?e(t.consequent,n).value:e(t.alternate,n).value;else if("Unary"===u||"Update"===u){var f=e(t.argument,n),d=f.value;o="!"===a?!d:"+"===a?+d:"-"===a?-d:"++"===a?d+1:"--"===a?d-1:null,"Update"===u&&(i=f.set,i&&(o=i(o)),t.prefix||(o+="++"===a?-1:1))}else if("Binary"===u||"Logical"===u||"Assignment"===u){var p=e(t.left,n),h=p.value,v=e(t.right,n).value;o="==="===a?h===v:"!=="===a?h!==v:"=="===a?h==v:"!="===a?h!=v:"<"===a?h<v:">"===a?h>v:"<="===a?h<=v:">="===a?h>=v:"&&"===a?h&&v:"||"===a?h||v:"+"===a?"string"==typeof(h+v)?r(h)+r(v):h+v:"-"===a?h-v:"*"===a?h*v:"/"===a?h/v:"%"===a?h%v:"*="===a?h*v:"/="===a?h/v:"%="===a?h%v:"+="===a?h+v:"-="===a?h-v:"="===a?v:null,"Assignment"===u&&(i=p.set,o=i(o))}else if("Call"===u||"NewExpression"===u){var m=t.callee.object?e(t.callee.object,n).value:n,b=e(t.callee,n).value,x=t.arguments.map(function(t){return e(t,n).value});o=b?"Call"===u?b.apply(m,x):new(b.bind.apply(b,x)):void 0}return{value:o,set:i}},d=[],p=function(e,t,r,n,o){var i={view:t,node:r,syntax:o,eval:function(){return f(arguments.length>0&&void 0!==arguments[0]?arguments[0]:o,i.view).value},exec:function(t){if(e[t]){var r;(r=e[t]).call.apply(r,[i,i.view,i.node].concat(s(n)))}}};if(e.template){var u=document.createElement("span");u.innerHTML=e.template,u=u.childNodes[0],Array.from(r.attributes).forEach(function(e){return u.setAttribute(e.name,e.value)}),r.parentNode.replaceChild(u,r),i.node=u}return i},h=function e(r,o,i,u){if([1,3].indexOf(o.nodeType)!==-1){var a=o.vElement;if(a)return void(u&&a.view!==r.$parent?a.view.$setParent(r):(i.push(a),l(a.children,function(e){return e.binds.forEach(function(e){return e.view=r})}),a.parent&&n(a.parent.children,a)));if(a=o.vElement={view:r,parent:u,node:o,children:[],binds:[],removedAttrs:[]},i.push(a),1===o.nodeType){var s=Array.from(o.attributes),f=void 0;a.binds=[],d.forEach(function(n){if(n.tag){var i=o.tagName.match(new RegExp("^"+n.tag.replace("{prefix}",m.prefix)+"$","i"));if(i){var u=p(n,r,o,i);a.binds.push(u),f=n.block||n.template,n.template&&e(r,u.node,a.children)}}else n.attribute&&(s=s.filter(function(i){if(!f){var u=i.name.match(new RegExp("^"+n.attribute.replace("{prefix}",m.prefix)+"$","i"));if(u){var s=t(i.value||"undefined");a.removedAttrs.push({name:i.name,value:i.value}),o.removeAttribute(i.name);var c=p(n,r,o,u,s);a.binds.push(c),f=n.block||n.template,n.template&&e(r,c.node,a.children)}return!u}}))}),f||Array.from(o.childNodes).forEach(function(t){e(r,t,a.children,a)})}else if(3===o.nodeType&&o.nodeValue.indexOf("{{")>-1){var h=o.nodeValue;t(h,"Text").forEach(function(e){var t=void 0;if("string"==typeof e)t=document.createTextNode(e);else{t=e.html?document.createElement("span"):document.createTextNode("");var n=p(c,r,t,["",e.html?"html":"text"],e.expression),u=Object.assign({},a,{binds:[n]});i.push(u),t.vElement=u}o.parentNode.insertBefore(t,o)}),o.parentNode.removeChild(o)}}},v=0,m=function e(r,o,a){r="string"==typeof r?document.querySelector(r):r[0]||r;var s=[],c={},d=[],p=void 0,m=function(){p||(i(function(){x.$(),p=void 0}),p=!0)},b=void 0,x={$id:v++,$vDOM:s,$:function(){b||(l(s,function(e){return e.binds.forEach(function(e){return e.exec("update")})}),x.$emit("update"))},$destroy:function(){l(s,function(e){e.binds.forEach(function(e){return e.exec("destroy")}),delete e.node.vElement,e.removedAttrs.forEach(function(t){return e.node.setAttribute(t.name,t.value)})}),b=!0,x.$emit("destroy")},$on:function(e,t){c[e]||(c[e]=[]),c[e].push(t)},$off:function(e,t){c[e]&&n(c[e],t)},$emit:function(e){c[e]&&c[e].forEach(function(e){return e()})},$watch:function(e,r){d.push({expr:e,syntax:t(e),cb:r})},$unwatch:function(e,t){var r=d.find(function(r){return r.expr===e&&r.cb===t});r&&n(d,r)},$setParent:function(e){var t=x.$parent;x.$parent=e,t&&t.$off&&t.$off("update",m),e.$on&&e.$on("update",m)}};x.$on("update",function(){d.forEach(function(e){var t=f(e.syntax,x).value;t!==e.val&&(e.val=t,e.cb(t))})}),x.$setParent(a||r.vElement&&r.vElement.view||e.root),h(x,r,s),l(s,function(e){return e.binds.forEach(function(e){return e.exec("create")})});var y=function e(t,r){if("object"!==("undefined"==typeof t?"undefined":u(t)))return t;var n=new Proxy(t,{get:function(e,t,r){var n=Reflect.get(e,t,r);return e instanceof Array||"function"!=typeof n?n:n.bind(e)},set:function(t,r,n,o){return t===x&&0===r.indexOf("$"),"object"!==("undefined"==typeof n?"undefined":u(n))||n instanceof Date||(n=e(n,!0)),m(),Reflect.set(t,r,n,o)}});return r&&(t instanceof Array?t.forEach(function(t,r){return n[r]=e(t,!0)}):Object.keys(t).forEach(function(r){return n[r]=e(t[r],!0)})),n};return m(),Object.assign(x,o),y(x)};Object.assign(m,{version:"0.2.1",parse:t,evaluate:f,prefix:"z-",directive:function(e){return e.inline&&(c=e),e.template&&(e.block=!0,e.order=.5),e.order||(e.order=100),d.push(e),d.sort(function(e,t){return e.order-t.order}),e},root:{$parent:"undefined"!=typeof global?global:window,number:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(e).toFixed(t)},percent:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2;return Number(100*e).toFixed(t)+"%"}}});var b=["selected","checked","disabled","readonly","multiple","ismap","defer","noresize"];return[{attribute:"{prefix}(text|html)",block:!0,inline:!0,create:function(e,t){t.innerHTML=""},update:function(e,t,n,o){var i=r(this.eval());i!==this.prevValue&&("html"===o?t.innerHTML=i:t.textContent=i,this.prevValue=i)}},{attribute:"{prefix}show",update:function(e,t){var r=this.eval()?"":"none";r!==this.prevValue&&(t.style.display=r,this.prevValue=r)}},{attribute:"{prefix}(?:attr-(.+)|("+["accept","accept-charset","accesskey","action","align","alt","async","autocomplete","autofocus","autoplay","autosave","buffered","challenge","charset","checked","cite","class","code","codebase","cols","colspan","content","contenteditable","contextmenu","controls","coords","crossorigin","data","data-*","datetime","default","defer","dir","dirname","disabled","download","draggable","dropzone","enctype","for","form","formaction","headers","hidden","high","href","hreflang","http-equiv","icon","id","integrity","ismap","itemprop","keytype","kind","label","lang","language","list","loop","low","manifest","max","maxlength","minlength","media","method","min","multiple","muted","name","novalidate","open","optimum","pattern","ping","placeholder","poster","preload","radiogroup","readonly","rel","required","reversed","rows","rowspan","sandbox","scope","scoped","seamless","selected","shape","size","sizes","slot","span","spellcheck","src","srcdoc","srclang","srcset","start","step","style","summary","tabindex","target","title","type","usemap","value","wrap"].join("|")+"))",
update:function(e,t,r,n,o){n=n||o;var i=this.eval();i!==this.prevValue&&(this.prevValue=i,b.indexOf(n)>-1&&(i=i?n:void 0),"undefined"==typeof i?t.removeAttribute(n):t.setAttribute(n,i))}},{attribute:"{prefix}class-(.+)",update:function(e,t,r,n){var o=!!this.eval();o!==this.prevValue&&(this.prevValue=o,t.classList.toggle(n,o))}},{attribute:"{prefix}exist",order:3,block:!0,create:function(e,t,r){this.marker=document.createComment(r),t.parentNode.replaceChild(this.marker,t)},update:function(e,t){var r=!!this.eval();r!==this.prevValue&&(r?(this.clone=t.cloneNode(!0),this.childView=m(this.clone,void 0,e),this.marker.parentNode.insertBefore(this.clone,this.marker)):this.clone&&(this.marker.parentNode.removeChild(this.clone),this.childView.$destroy(),delete this.childView),this.prevValue=r)}},{attribute:"{prefix}(?:style-(.+)|("+["align-.*","all","animation","animation-.*","backface-visibility","background","background-.*","border","border-.*","bottom","box-.*","break-.*","caption-side","caret-color","clear","clip","clip-path","color","column-.*","columns","content","counter-.*","cursor","direction","display","empty-cells","filter","flex-.*","float","font","font-.*","grid","grid-.*","height","hyphens","image-.*","ime-mode","inline-size","isolation","justify-content","left","letter-spacing","line-.*","list-.*","margin","margin-.*","mask","mask-.*","max-height","max-width","min-block-size","min-height","min-inline-size","min-width","mix-blend-mode","object-fit","object-position","offset-.*","opacity","order","orphans","outline","outline-.*","overflow","overflow-.*","padding","padding-.*","page-break-.*","perspective","perspective-origin","pointer-events","position","quotes","resize","right","scroll-.*","shape-.*","tab-size","table-layout","text-.*","top","touch-action","transform","transform-.*","transition","transition-.*","unicode-bidi","unset","vertical-align","visibility","white-space","widows","width","will-change","word-.*","writing-mode","z-index"].join("|")+"))",update:function(e,t,r,n,o){var i=this.eval();i!==this.prevValue&&(this.prevValue=i,t.style[n||o]=i)}},{attribute:"{prefix}model",block:!0,create:function(e,r){var n=this,i=r.tagName.toLowerCase(),u=(r.getAttribute("type")||"").toLowerCase();this.type="checkbox"===u?"checkbox":"select"===i?"select":"radio"===u?"radio":["range","number"].indexOf(u)>-1?"number":["date","datetime-local","time","month","week"].indexOf(u)>-1?"date":"text","radio"!==this.type||r.getAttribute("name")||r.setAttribute("name",o(e.$id+JSON.stringify(this.syntax))),this.getValue=function(e){var r=e.getAttribute("z-value");return r?n.eval(t(r)):e.getAttribute("value")},this.handler=function(){if("radio"!==n.type||r.checked){var t="checkbox"===n.type?!!r.checked:"select"===n.type?n.getValue(r.options[r.selectedIndex]):"radio"===n.type?n.getValue(r):"number"===n.type?Number(r.value):"date"===n.type?r.valueAsDate:r.value;t!==n.prevValue&&(n.prevValue=t,n.eval({type:"Assignment",operator:"=",left:n.syntax,right:{type:"Literal",value:t}}),e.$())}},r.addEventListener("input",this.handler),r.addEventListener("change",this.handler),"select"===this.type&&(r.selectedIndex=-1)},update:function(e,t){var n=this,o=this.eval();if(o!==this.prevValue){if("checkbox"===this.type)t.checked=!!o;else if("select"===this.type)t.selectedIndex=Array.from(t.options).reduce(function(e,t,i){var u=n.getValue(t);return t.setAttribute("value",r(u)),u===o?i:e},-1);else if("radio"===this.type){var i=this.getValue(t);t.checked=o===i,t.setAttribute("value",r(i))}else"number"===this.type?t.value=Number(o):"date"===this.type?t.valueAsDate=o:t.value=r(o);this.prevValue=o}},destroy:function(e,t){t.removeEventListener("input",this.handler),t.removeEventListener("change",this.handler)}},{attribute:"{prefix}(.+)-in",order:2,block:!0,create:function(e,t,r){this.items=[],this.marker=document.createComment(r),this.key=function(e){return JSON.stringify(e)},t.parentNode.replaceChild(this.marker,t)},update:function(e,t,r,o){var i=this,u=this.eval()||[],s=document.createDocumentFragment();this.items.forEach(function(e){u.find(function(t){return i.key(t)===i.key(e.data)})||(e.view.$destroy(),i.marker.parentNode.removeChild(e.el),n(i.items,e))}),u.forEach(function(e){var r=i.items.find(function(t){return i.key(t.data)===i.key(e)});r||(r={el:t.cloneNode(!0),data:e},i.items.push(r),s.appendChild(r.el))}),this.marker.parentNode.insertBefore(s,this.marker),this.items.forEach(function(t){t.view||(t.view=m(t.el,a({},o,t.data),e))})}},{attribute:"{prefix}(?:on-(.+)|("+["load","error","focus","blur","click","dblclick","mouse.*","keyup","keydown","keypress","input","change","submit","reset","scroll","resize","drag.*","drop"].join("|")+"))",create:function(e,t,r,n,o){var i=this;this.handler=function(t){e.$event=t,i.eval(),delete e.$event},t.addEventListener(n||o,this.handler)},destroy:function(e,t,r,n,o){t.removeEventListener(n||o,this.handler)}},{attribute:"{prefix}skip",order:1,block:!0}].forEach(m.directive),m});
